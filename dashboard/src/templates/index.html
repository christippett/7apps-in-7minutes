{% with %} {% if not debug %} {% set asset_suffix = "?ts=" + unix_timestamp|string %} {%
endif %}
<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>7Apps â€” Google Cloud</title>
    <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bulma@0.9.0/css/bulma.min.css"
    />
    <link href="/static/index.css{{ asset_suffix }}" rel="stylesheet" />
    <script
      src="https://cdn.jsdelivr.net/gh/alpinejs/alpine@v2.x.x/dist/alpine.min.js"
      defer
    ></script>
  </head>

  <body>
    <section class="container">
      <div class="content has-text-centered mb-6">
        <p class="title is-fancy is-3">7-Apps in 7-minutes</p>
        <p class="subtitle is-italic is-6">
          Deploying a Python Flask app to every service on
          <span class="google-logo">{% include "misc/google-cloud-logo.svg" %}</span>
        </p>
      </div>
      <div class="iframe-container columns is-variable is-multiline is-relative">
        <div id="timeline" class="timeline-container is-overlay"></div>
        {% include "content/iframes.html" %} {% include "content/build.html" %}
      </div>
    </section>
    <footer>
      <div class="content has-text-centered has-text-grey">
        <p>
          Source on
          <a href="https://github.com/servian/7apps7minutes" target="_blank">GitHub</a>.
          Licensed
          <a href="http://opensource.org/licenses/mit-license.php" target="_blank">MIT</a>
        </p>
      </div>
    </footer>
  </body>
  <script
    src="https://cdnjs.cloudflare.com/ajax/libs/labella/1.1.4/labella.min.js"
    integrity="sha512-CvciuHWpGI0ygZhWN/t/zqiiDI26Zclrsqcd77VDLYN5MyfyyPvy18eFwWZZUdUgofBi/vbOKUAqPRIJ7GyO0g=="
    crossorigin="anonymous"
  ></script>
  <script
    src="https://cdnjs.cloudflare.com/ajax/libs/d3/5.16.0/d3.min.js"
    integrity="sha512-FHsFVKQ/T1KWJDGSbrUhTJyS1ph3eRrxI228ND0EGaEp6v4a/vGwPWd3Dtd/+9cI7ccofZvl/wulICEurHN1pg=="
    crossorigin="anonymous"
  ></script>
  <script src="https://ajax.googleapis.com/ajax/libs/webfont/1.6.26/webfont.js"></script>
  <script src="/static/utils.js{{ asset_suffix }}"></script>
  <script src="/static/timeline.js{{ asset_suffix }}"></script>
  <script>
    {%- include "props.js" -%}
  </script>
  <script>
    const timelineOptions = {
      margin: { left: 40, right: 0, top: 50, bottom: 50 },
      maxValue: 10 * 60, // max seconds
      tickValue: 30,
      labella: {
        renderer: { layerGap: 50, direction: "right" },
        force: { minPos: -10, nodeSpacing: 10 },
      },
    };

    function data() {
      return {
        isFullscreen: false,
        isLoading: false,
        themeOpt: 0,
        tooltips: [],
        tooltip: new Tooltip({ collection: this.tooltips }),
        builder: new AppBuilder({
          appService: new AppService(),
          logHandler: new LogHandler(document.getElementById("logs")),
          notifier: new NotificationService(),
          timeline: new Timeline({ opts: timelineOptions, el: "#timeline" }),
        }),
        init() {
          this.tooltip._tooltips = this.tooltips;
          this.builder.init({ externalRef: { ...this, ...props } });
        },
        selectTheme(opt) {
          let themeCount = props.fonts.length - 1;
          if (opt > themeCount) {
            this.themeOpt = 0;
          } else if (opt < 0) {
            this.themeOpt = themeCount;
          } else {
            this.themeOpt = opt;
          }
        },
        themeStyle(scope) {
          let colors = props.gradients[this.themeOpt].colors;
          let primaryColor = colors[0];
          if (scope === "preview") {
            return [
              `background: ${primaryColor};`,
              `background: linear-gradient(45deg,${colors.join(",")}) 0% 0% / 400% 400%;`,
            ].join(" ");
          } else if (scope === "title") {
            return `font-family: '${props.fonts[this.themeOpt]}';`;
          }
        },
        previewUrl() {
          let font = encodeURIComponent(props.fonts[this.themeOpt]);
          let asciiFont = encodeURIComponent(props.asciiFonts[this.themeOpt]);
          let gradient = encodeURIComponent(props.gradients[this.themeOpt].name);
          return `https://function.7apps.cloud/?font=${font}&ascii_font=${asciiFont}&gradient=${gradient}`;
        },
      };
    }
  </script>
</html>
{% endwith %}
