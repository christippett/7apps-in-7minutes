{% with %} {% if not debug %} {% set asset_suffix = "?ts=" + unix_timestamp|string %} {%
endif %}
<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>7Apps â€” Google Cloud</title>
    <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bulma@0.9.0/css/bulma.min.css"
    />
    <link href="/static/index.css{{ asset_suffix }}" rel="stylesheet" />
    <script
      src="https://cdn.jsdelivr.net/gh/alpinejs/alpine@v2.x.x/dist/alpine.min.js"
      defer
    ></script>
  </head>

  <body>
    <section class="container is-flex">
      <div class="columns is-centered">
        <div x-data="{ tab: 'timeline' }" class="column has-text-grey is-relative my-6">
          <div class="content">
            <p class="title is-4">7-Apps in 7-minutes</p>
            <p class="subtitle is-6">
              One codebase. Seven services.
            </p>
          </div>
          <nav class="mb-5">
            <div class="tabs">
              <ul>
                <li :class="{ 'is-active': tab === 'overview' }">
                  <a @click="tab = 'overview'">
                    <span>Overview</span>
                  </a>
                </li>
                <li :class="{ 'is-active': tab === 'timeline' }">
                  <a @click="tab = 'timeline'">
                    <span>Timeline</span>
                  </a>
                </li>
              </ul>
            </div>
          </nav>
          <div x-show="tab === 'overview'" class="container">
            {% include "content/overview.html" %}
          </div>
          <div x-show="tab === 'timeline'" class="container">
            {% include "content/timeline.html" %}
          </div>
        </div>
        <div class="column is-7-desktop is-offset-1 columns is-multiline">
          {% include "content/iframes.html" %}
        </div>
      </div>
    </section>
    <footer>
      <div class="content has-text-centered has-text-grey">
        <p>
          Source on
          <a
            href="https://github.com/servian/7apps7minutes"
            target="_blank"
            rel="noopener noreferrer"
            >GitHub</a
          >. Licensed <a href="http://opensource.org/licenses/mit-license.php">MIT</a>.
        </p>
      </div>
    </footer>
  </body>
  <script
    src="https://cdnjs.cloudflare.com/ajax/libs/labella/1.1.4/labella.min.js"
    integrity="sha512-CvciuHWpGI0ygZhWN/t/zqiiDI26Zclrsqcd77VDLYN5MyfyyPvy18eFwWZZUdUgofBi/vbOKUAqPRIJ7GyO0g=="
    crossorigin="anonymous"
  ></script>
  <script
    src="https://cdnjs.cloudflare.com/ajax/libs/d3/5.16.0/d3.min.js"
    integrity="sha512-FHsFVKQ/T1KWJDGSbrUhTJyS1ph3eRrxI228ND0EGaEp6v4a/vGwPWd3Dtd/+9cI7ccofZvl/wulICEurHN1pg=="
    crossorigin="anonymous"
  ></script>

  <script src="/static/utils.js{{ asset_suffix }}"></script>
  <script src="/static/timeline.js{{ asset_suffix }}"></script>
  <script>
    /* eslint-disable no-undef */

    function appDeploy() {
      return {
        id: null,
        isActive: false,
        isLoading: false,
        async deploy() {
          this.isLoading = true;
          console.debug("deploying app");
          this.id = await _.appService.deployUpdate({
            gradient: this.gradient,
            asciiFont: this.asciiFont,
            font: this.font,
          });
          console.debug(`deployment request sent: ${this.id}`);
          setTimeout(() => (this.isLoading = false), 15000);
          this.isActive = true;
        },
      };
    }

    // Add callback to update timeline during app deployments
    _.appService.addSubscription(({ app, duration }) => {
      console.log(`Adding ${app.name} to timeline`);
      _.timeline.push({
        id: app.name,
        label: app.title,
        theme: app.theme,
        value: duration,
      });
    });
  </script>
</html>
{% endwith %}
