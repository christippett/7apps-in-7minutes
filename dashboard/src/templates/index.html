<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>7Apps â€” Google Cloud</title>
  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.0/css/bulma.min.css" />
  <link rel="stylesheet" href="https://cdn.materialdesignicons.com/5.3.45/css/materialdesignicons.min.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.0.0/animate.min.css" />
  <link href="/static/index.css?ts={{ unix_timestamp }}" rel="stylesheet" />
  <script src="https://cdn.jsdelivr.net/gh/alpinejs/alpine@v2.x.x/dist/alpine.min.js" defer></script>
</head>

<body>
  <section class="container is-flex">
    <div class="columns is-centered">
      <div x-data="{ tab: 'timeline' }" class="column has-text-grey is-relative my-6">
        <div class="content">
          <p class="title is-4">7-Apps on Google Cloud</p>
          <p class="subtitle is-6">
            One codebase. Seven services.
          </p>
        </div>
        <nav class="mb-5">
          <div class="tabs">
            <ul>
              <li :class="{ 'is-active': tab === 'overview' }">
                <a @click="tab = 'overview'">
                  <span>Overview</span>
                </a>
              </li>
              <li :class="{ 'is-active': tab === 'timeline' }">
                <a @click="tab = 'timeline'">
                  <span>Timeline</span>
                </a>
              </li>
            </ul>
          </div>
        </nav>
        <div x-show="tab === 'overview'" class="container">
          {% include "content/overview.html" %}
        </div>
        <div x-show="tab === 'timeline'" class="container">
          {% include "content/timeline.html" %}
        </div>
      </div>
      <div class="column is-7-desktop is-offset-1 columns is-multiline">
        {% include "content/iframes.html" %}
      </div>
    </div>
  </section>
  <footer>
    <div class="content has-text-centered has-text-grey">
      <p>
        Source on
        <a href="https://github.com/servian/7apps7minutes" target="_blank" rel="noopener noreferrer">GitHub</a>.
        Licensed <a href="http://opensource.org/licenses/mit-license.php">MIT</a>.
      </p>
    </div>
  </footer>
</body>
<script src="/static/utils.js?ts={{ unix_timestamp }}"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/labella/1.1.4/labella.min.js"
  integrity="sha512-CvciuHWpGI0ygZhWN/t/zqiiDI26Zclrsqcd77VDLYN5MyfyyPvy18eFwWZZUdUgofBi/vbOKUAqPRIJ7GyO0g=="
  crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/d3/5.16.0/d3.min.js"
  integrity="sha512-FHsFVKQ/T1KWJDGSbrUhTJyS1ph3eRrxI228ND0EGaEp6v4a/vGwPWd3Dtd/+9cI7ccofZvl/wulICEurHN1pg=="
  crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/humanize-duration/3.23.1/humanize-duration.min.js"
  integrity="sha512-om3N51eLuxygBOt9NLKvGQAlFU/0w4z77iF6csfGevWBlBw02Xv9SLtVii85n160wQyHJboLPL2CvKbi0BJaYw=="
  crossorigin="anonymous"></script>
<script src="/static/timeline.js?ts={{ unix_timestamp }}"></script>
<script>
  /* eslint-disable no-undef */

  // =======================
  // Connect WebSocket
  // =======================
  LogStreamClient.connect();

  App.startMonitor({ interval: 5000 });

  // =======================
  // Timeline
  // =======================
  var options = {
    margin: { left: 25, right: 0, top: 25, bottom: 0 },
    initialWidth: 250,
    initialHeight: 450,
    timelineLimit: 10 * 60, // max seconds
    labella: {
      renderer: {
        layerGap: 50,
        direction: "right",
      },
      force: {
        minPos: -10,
        nodeSpacing: 8,
      },
    },
  };
  var timeline = Timeline({ options });
  timeline.create("#timeline");

  App.subscribe((payload) => {
    let { app } = payload;
    console.log(`Adding ${app.name} to timeline`);
    timeline.add({
      id: app.name,
      name: app.title,
      colors: app.config.colors,
      duration: app.buildDuration,
    });
  });
</script>

</html>
